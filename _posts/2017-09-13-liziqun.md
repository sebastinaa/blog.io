---
layout: post
title: 粒子群算法
date: 2017-09-13
categories: blog
tags: [粒子群算法]
description: 粒子群优化算法（ParticleSwarm Optimization，简称PSO）, 是在1995年由Eberhart博士和Kennedy博士一起提出的，它源于对鸟群捕食行为的研究。

---

一、粒子群算法介绍

它的基本核心是利用群体中的个体对信息的共享从而使得整个群体的运动在问题求解空间中产生从无序到有序的演化过程，从而获得问题的最优解。我们可以利用一个有关PSO的经典描述来对PSO算法进行一个直观的描述。设想这么一个场景：一群鸟进行觅食，而远处有一片玉米地，所有的鸟都不知道玉米地到底在哪里，但是它们知道自己当前的位置距离玉米地有多远。那么找到玉米地的最佳策略，也是最简单有效的策略就是是搜寻目前距离玉米地最近的鸟群的周围区域。PSO就是从这种群体觅食的行为中得到了启示，从而构建的一种优化模型。

在PSO中，每个优化问题的解都是搜索空间中的一只鸟，称之为“粒子”，而问题的最优解就对应为鸟群要寻找的“玉米地”。所有的粒子都具有一个位置向量（粒子在解空间的位置）和速度向量（决定下次飞行的方向和速度），并可以根据目标函数来计算当前的所在位置的适应值（fitness value），可以将其理解为距离“玉米地”的距离。在每次的迭代中，种群中的粒子除了根据自身的“经验”（历史位置）进行学习以外，还可以根据种群中最优粒子的“经验”来学习，从而确定下一次迭代时需要如何调整和改变飞行的方向和速度。就这样逐步迭代，最终整个种群的粒子就会逐步趋于最优解。

---

二、算法原理介绍

粒子群算法是模拟鸟群蜂群的觅食行为的一种算法。基本思想是通过群体中个体之间的协作和信息共享来寻找最优解。试着想一下一群鸟在寻找食物，在这个区域中只有一只虫子，所有的鸟都不知道食物在哪。但是它们知道自己的当前位置距离食物有多远，同时它们知道离食物最近的鸟的位置。想一下这时候会发生什么？

      鸟A：哈哈哈原来虫子离我最近！
      鸟B,C,D：我得赶紧往 A 那里过去看看！
 
同时各只鸟在位置不停变化时候离食物的距离也不断变化，所以一定有过离食物最近的位置，这也是它们的一个参考。

      鸟某某：我刚刚的位置好像靠近了食物，我得往那里靠近！
      
综上，影响鸟的运动状态变化有下面两个因素：

- 离食物最近的鸟的位置；

- 自己之前达到过的离食物最近的位置。

而鸟每次的位置变化除了考虑上面两个因素还有一个因素: **惯性**！

所以考虑这**三个因素**，位置变化量 v 的公式如下：

 <a href="https://www.codecogs.com/eqnedit.php?latex=v_{id}^{k&plus;1}=wv_{id}^k&plus;c_{1}()(p_{id}-x_{id}^k)&plus;c_{2}rand()(p_{gbest}-x_{id}^k)rand" target="_blank"><img src="https://latex.codecogs.com/gif.latex?v_{id}^{k&plus;1}=wv_{id}^k&plus;c_{1}()(p_{id}-x_{id}^k)&plus;c_{2}rand()(p_{gbest}-x_{id}^k)rand" title="v_{id}^{k+1}=wv_{id}^k+c_{1}()(p_{id}-x_{id}^k)+c_{2}rand()(p_{gbest}-x_{id}^k)rand" /></a>
 
---


---

三、算法步骤

 1. 编码，并随机初始化物种
 
 2. 计算每个物种的适应度
 
 3. 淘汰与复制，去掉适应度最小的物种，复制适应度最大的物种。可以认为是：长得帅的留下可以交配，丑的淘汰，哈哈，我是留下的那种吧。
 
 4. 交换，交换 DNA 中的基因。你懂的啦！DNA 交换才能产生更优秀（适应度更高）的人后代，这里交换是用随机选两个生物，随机交换DNA中的一段，因为有了上面的淘汰和复制，所以获得交配（换）权的生物有更大概率是适应度高的生物。
 
 5. 变异。和《进化论》里一样，基因变异是个小概率事件，且不一定往好的方向变还是往差的方向变，但是！如果没有变异，有些基因可能永远不会出现。
 例如：0001 和 1000 无论怎么交换也不能产生 1100，但是，概率一定要小，太大了就不稳定了。
 
 6. 判断物种达到稳定。判断物种达到稳定有很多种方法，我这里是用的总的适应度变化来判断的，越到到后来物种会趋于相同的 DNA ,当适应度变化幅度很小时，认为物种趋于稳定，此时活下来的就是趋近于函数极值的解。
 
四、算法代码

         %% 清空环境
         clc
         clear
         %% 参数初始化
			%粒子群算法中的参数设置，根据实际自行更改
		c1 = 1.49445;   %非负常数，加速度因子
		c2 = 1.49445;   %非负常数，加速度因子
		maxgen=300;   % 进化次数 
		sizepop=20;   %种群规模
		Vmax=0.5;   %粒子最大更新速度
		Vmin=-0.5;   %粒子最小更新速度
		popmax=2;     %自变量最大值
		popmin=-2;    %自变量最小值
		%%------------------产生初始粒子和速度----------------------------
		for i=1:sizepop
		%随机产生一个种群
		pop(i,:)=2*rands(1,2);  %初始种群，意思是pop的第i行是两个-2到2之间的随机数，即自变量范围，每次生成两个数，及对应的（x，y）
		V(i,:)=0.5*rands(1,2);    %初始化速度，同上
		%计算适应度
			fitness(i)=fun(pop(i,:));   %染色体的适应度
		end
		%%----------------个体极值和群体极值-------------------------------
		[bestfitness bestindex]=max(fitness);
		zbest=pop(bestindex,:);   %全局最佳
		gbest=pop;    %个体最佳
		fitnessgbest=fitness;   %个体最佳适应度值
		fitnesszbest=bestfitness;   %全局最佳适应度值
		%%----------------迭代寻优------------------------------------------------
		for i=1:maxgen
			for j=1:sizepop
			%速度更新公式
         V(j,:) = V(j,:) + c1*rand*(gbest(j,:) - pop(j,:)) + c2*rand*(zbest -  pop(j,:));%式（13.1）
         V(j,find(V(j,:)>Vmax))=Vmax;%检查速度是否超出规定的范围
         V(j,find(V(j,:)<Vmin))=Vmin;
         %种群更新公式
         pop(j,:)=pop(j,:)+V(j,:);%式（13.1）
         pop(j,find(pop(j,:)>popmax))=popmax;%检查自变量是否超出规定的范围
         pop(j,find(pop(j,:)<popmin))=popmin;
         %函数适应度值
         fitness(j)=fun(pop(j,:));
			end
			for j=1:sizepop
         %个体最优更新，找最大值，那么如果后者大于前者，那么保存后者
         if fitness(j) >  fitnessgbest(j)   %如果寻的是最小值，那么改成<就可以了
            gbest(j,:) = pop(j,:);  
            fitnessgbest(j) =  fitness(j);    %一次进化后通过比较选出最优个体
         end
         %群体最优更新,同样的，如果后者大于前者，那么保存后者
         if fitness(j) >  fitnesszbest    %如果寻的是最小值，那么改成<就可以了
            zbest = pop(j,:);    
            fitnesszbest = fitness(j);  %与之前选取的最优个体相对比，从中再次筛选
         end
			end
			yy(i)=fitnesszbest;           %保存当前最优个体
			end
			%%------------------------结果分析--------------------------------
			plot(yy)    %将每次进化后筛选出来的最优个体，即最大值画出
			title('最优个体适应度','fontsize',12);
			xlabel('进化代数','fontsize',12);ylabel('适应度','fontsize',12);
 
 
 
 
 5. 
 

 [关于我](http://beamer.top/about/)

这里有我的个人简介：[关于我](http://beamer.top/about/)

如果你想看到我最新的文章，可以关注我的csdn博客「lemaden520」[点此进入](http://blog.csdn.net/lemaden520/article/details/77657697)。
